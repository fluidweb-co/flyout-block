!function(t,e){"function"==typeof define&&define.amd?define([],e()):"object"==typeof exports?module.exports=e():t.FlyoutBlock=e()}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";function n(t){if(!t)return!1;var e=t.getAttribute(i.targetElementAttribute);return e&&""!=e?document.querySelector(e):t.closest(i.flyoutWrapperSelector)}function l(t){var e,o;t.target.closest(i.toggleButtonSelector)?(t.preventDefault(),e=t.target.closest(i.toggleButtonSelector),o=n(e),r.toggle(o)):t.target.closest(i.flyoutToggleClassSelector)?(t.target.closest(i.flyoutTogglePassActionSelector)||t.preventDefault(),(o=function(t){if(!t)return!1;for(var e=0;e<t.classList.length;e++){var o=t.classList[e];if(0==o.indexOf(i.flyoutClassTogglePrefix)){o="#"+o.replace(i.flyoutClassTogglePrefix,"");return document.querySelector(o)}}return!1}(t.target.closest(i.flyoutToggleClassSelector)))&&r.toggle(o)):t.target.closest(i.openButtonSelector)?(t.preventDefault(),e=t.target.closest(i.openButtonSelector),o=n(e),r.open(o)):t.target.closest(i.closeButtonSelector)?(t.preventDefault(),e=t.target.closest(i.closeButtonSelector),o=n(e),r.close(o)):t.target.matches(i.flyoutWrapperSelector)?(o=n(t.target),r.close(o)):t.target.closest(i.overlaySelector)&&r.closeAll()}function s(t){27!=t.keyCode&&27!=t.which&&"Escape"!=t.key&&"Esc"!=t.key||r.closeAll()}var a=!1,r={managers:[]},i={},u={flyoutWrapperSelector:"[data-flyout]",flyoutContentSelector:"[data-flyout-content]",toggleButtonSelector:"[data-flyout-toggle]",openButtonSelector:"[data-flyout-open]",closeButtonSelector:"[data-flyout-close]",overlaySelector:"[data-flyout-overlay]",flyoutTogglePassActionSelector:"[data-flyout-pass-action], .js-flyout-pass-action",flyoutToggleClassSelector:".js-flyout-toggle",flyoutClassTogglePrefix:"js-flyout-target-",idPrefix:"flyout-block",bodyHasFlyoutClass:"has-flyout",bodyHasFlyoutOpenClass:"has-flyout--open",isActivatedClass:"is-activated",isOpenClass:"is-open",openAnimationClass:"slide-in-up",closeAnimationClass:"slide-out-down",targetElementAttribute:"data-flyout-target",openAnimationClassAttribute:"data-flyout-open-animation-class",closeAnimationClassAttribute:"data-flyout-close-animation-class",manualFocusAttribute:"data-flyout-manual-focus",autoFocusAttribute:"data-autofocus",flyoutRoleAttribute:"data-flyout-role",overlayTemplate:'<div class="flyout-overlay" data-flyout-overlay></div>'},c="open",d="closed",g=function(){var o={},n=!1,t=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],t++);for(;t<arguments.length;t++)!function(t){for(var e in t)t.hasOwnProperty(e)&&(n&&"[object Object]"===Object.prototype.toString.call(t[e])?o[e]=g(o[e],t[e]):o[e]=t[e])}(arguments[t]);return o};r.getState=function(t){t=r.getInstance(t);return!!t&&t.state},r.open=function(t){var o=r.getInstance(t);if(!o)return!1;o.previousActiveElement=document.activeElement,AnimateHelper.doThenAnimate(t,o.settings.openAnimationClass,function(){var t,e;o.state=c,o.wasHidden=o.element.hasAttribute("hidden"),o.element.removeAttribute("hidden"),o.element.classList.add(o.settings.isOpenClass),document.body.classList.add(o.settings.bodyHasFlyoutOpenClass,o.settings.bodyHasFlyoutOpenClass+"-"+o.element.id),o.element.hasAttribute(o.settings.manualFocusAttribute)||(t=o.element.querySelector("["+o.settings.autoFocusAttribute+"]"),console.log(t),t||0<(e=function(t){t=(t=t||document).querySelectorAll('a, button, input:not([type="hidden"]), textarea, select, details,[tabindex]:not([tabindex="-1"])');return Array.from(t).filter(function(t){return!t.hasAttribute("disabled")})}(o.element).filter(function(t){return!t.matches(o.settings.closeButtonSelector)})).length&&(t=e[0]),(t||o.contentElement).focus())})},r.close=function(t){var e=r.getInstance(t);if(!e)return!1;AnimateHelper.animateThenDo(t,e.settings.closeAnimationClass,function(){e.state=d,e.element.classList.remove(e.settings.isOpenClass),document.body.classList.remove(e.settings.bodyHasFlyoutOpenClass+"-"+e.element.id),e.wasHidden&&e.element.setAttribute("hidden",""),e.element.wasHidden=void 0,r.hasAnyElementOpen()||document.body.classList.remove(e.settings.bodyHasFlyoutOpenClass),e.previousActiveElement&&e.previousActiveElement.focus()})},r.closeAll=function(){for(var t=0;t<r.managers.length;t++){var e=r.managers[t];r.getState(e.element)!=d&&r.close(e.element)}},r.toggle=function(t){r.getState(t)==d?r.open(t):r.close(t)},r.getInstance=function(t){for(var e,o=0;o<r.managers.length;o++){var n=r.managers[o];if(n.element==t){e=n;break}}return e},r.hasAnyElementOpen=function(){for(var t=0;t<r.managers.length;t++)if(r.managers[t].state==c)return!0;return!1},r.initializeTrigger=function(t){t.removeAttribute("disabled"),t.removeAttribute("aria-hidden"),t.setAttribute("tabindex","0"),t.setAttribute("role","button");var e=t.getAttribute("href");null!=e&&""!=e&&(document.querySelector(e)&&t.setAttribute(i.targetElementAttribute,e),t.getAttribute(i.targetElementAttribute)&&t.removeAttribute("href"))},r.initializeElement=function(t){var e={};e.element=t,e.settings=g(i),e.state=d,e.element.id&&""!=e.element.id||(e.element.id=e.settings.idPrefix+"-"+r.managers.length),e.contentElement=e.element.querySelector(e.settings.flyoutContentSelector);var o=e.element.getAttribute(e.settings.openAnimationClassAttribute),t=e.element.getAttribute(e.settings.closeAnimationClassAttribute);e.settings.openAnimationClass=o&&""!=o?o:i.openAnimationClass,e.settings.closeAnimationClass=t&&""!=t?t:i.closeAnimationClass;t="alert"==e.element.getAttribute(e.settings.flyoutRoleAttribute)||"alertdialog"==e.element.getAttribute(e.settings.flyoutRoleAttribute)?"alertdialog":"dialog";e.contentElement.setAttribute("role",t),e.isActivated=!0,e.element.classList.add(e.settings.isActivatedClass),r.managers.push(e)};function e(t){i=g(u,t);for(var e=document.querySelectorAll(i.flyoutWrapperSelector),o=0;o<e.length;o++)r.initializeElement(e[o]);for(var t=i.toggleButtonSelector+", "+i.openButtonSelector+", "+i.closeButtonSelector,n=document.querySelectorAll(t),o=0;o<n.length;o++)r.initializeTrigger(n[o]);(t=document.createElement("div")).innerHTML=i.overlayTemplate.trim(),document.body.appendChild(t.childNodes[0]),document.addEventListener("click",l),document.addEventListener("keydown",s,!0),document.body.classList.add(i.bodyHasFlyoutClass),a=!0}return r.init=function(t){a||(window.AnimateHelper?e(t):window.RequireBundle&&RequireBundle.require(["animate-helper"],function(){e(t)}))},r});
//# sourceMappingURL=maps/flyout-block.min.js.map
