!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FlyoutBlock=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function n(e){if(!e)return!1;var t=e.getAttribute(i.targetElementAttribute);return t&&""!=t?document.querySelector(t):e.closest(i.flyoutWrapperSelector)}function l(e){var t,o;e.target.closest(i.toggleButtonSelector)?(e.preventDefault(),t=e.target.closest(i.toggleButtonSelector),o=n(t),a.toggle(o)):e.target.closest(i.flyoutToggleClassSelector)?(e.target.closest(i.flyoutTogglePassActionSelector)||e.preventDefault(),(o=function(e){if(!e)return!1;for(var t=0;t<e.classList.length;t++){var o=e.classList[t];if(0==o.indexOf(i.flyoutClassTogglePrefix)){o="#"+o.replace(i.flyoutClassTogglePrefix,"");return document.querySelector(o)}}return!1}(e.target.closest(i.flyoutToggleClassSelector)))&&a.toggle(o)):e.target.closest(i.openButtonSelector)?(e.preventDefault(),t=e.target.closest(i.openButtonSelector),o=n(t),a.open(o)):e.target.closest(i.closeButtonSelector)?(e.preventDefault(),t=e.target.closest(i.closeButtonSelector),o=n(t),a.close(o)):e.target.matches(i.flyoutWrapperSelector)?(o=n(e.target),a.close(o)):e.target.closest(i.overlaySelector)&&a.closeAll()}function r(e){var t,o,n;e.defaultPrevented||(void 0!==(t=e).key?o=void 0!==(n=p[t.key])?n:t.key:void 0!==t.keyCode&&(o=void 0!==(n=p[b[t.keyCode]])?n:t.keyCode),(o=o)==f&&a.closeAll(),o!=g&&o!=m||!e.target.closest(i.triggerSelectors)||l(e))}var s=!1,a={managers:[]},i={},u={flyoutWrapperSelector:"[data-flyout]",flyoutContentSelector:"[data-flyout-content]",toggleButtonSelector:"[data-flyout-toggle]",openButtonSelector:"[data-flyout-open]",closeButtonSelector:"[data-flyout-close]",overlaySelector:"[data-flyout-overlay]",flyoutTogglePassActionSelector:"[data-flyout-pass-action], .js-flyout-pass-action",flyoutToggleClassSelector:".js-flyout-toggle",flyoutClassTogglePrefix:"js-flyout-target-",idPrefix:"flyout-block",bodyHasFlyoutClass:"has-flyout",bodyHasFlyoutOpenClass:"has-flyout--open",isActivatedClass:"is-activated",isOpenClass:"is-open",openAnimationClass:"slide-in-up",closeAnimationClass:"slide-out-down",targetElementAttribute:"data-flyout-target",openAnimationClassAttribute:"data-flyout-open-animation-class",closeAnimationClassAttribute:"data-flyout-close-animation-class",manualFocusAttribute:"data-flyout-manual-focus",autoFocusAttribute:"data-autofocus",flyoutRoleAttribute:"data-flyout-role",overlayTemplate:'<div class="flyout-overlay" data-flyout-overlay></div>'},c="open",d="closed",g="Enter",f="Escape",m=" ",t="ArrowLeft",o="ArrowUp",y="ArrowRight",A="ArrowDown",p={Tab:"Tab",Enter:g,Return:g,Escape:f,Esc:f," ":m,Spacebar:m,End:"End",Home:"Home",ArrowLeft:t,Left:t,ArrowUp:o,Up:o,ArrowRight:y,Right:y,ArrowDown:A,Down:A},b={9:"Tab",13:"Enter",27:"Escape",32:" ",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown"},v=function(){var o={},n=!1,e=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],e++);for(;e<arguments.length;e++)!function(e){for(var t in e)e.hasOwnProperty(t)&&(n&&"[object Object]"===Object.prototype.toString.call(e[t])?o[t]=v(o[t],e[t]):o[t]=e[t])}(arguments[e]);return o};a.getState=function(e){e=a.getInstance(e);return!!e&&e.state},a.open=function(e){var o=a.getInstance(e);if(!o)return!1;o.previousActiveElement=document.activeElement,AnimateHelper.doThenAnimate(e,o.settings.openAnimationClass,function(){var e,t;o.state=c,o.wasHidden=o.element.hasAttribute("hidden"),o.element.removeAttribute("hidden"),o.element.classList.add(o.settings.isOpenClass),document.body.classList.add(o.settings.bodyHasFlyoutOpenClass,o.settings.bodyHasFlyoutOpenClass+"-"+o.element.id),o.element.hasAttribute(o.settings.manualFocusAttribute)||(e=o.element.querySelector("["+o.settings.autoFocusAttribute+"]"),console.log(e),e||0<(t=function(e){e=(e=e||document).querySelectorAll('a, button, input:not([type="hidden"]), textarea, select, details,[tabindex]:not([tabindex="-1"])');return Array.from(e).filter(function(e){return!e.hasAttribute("disabled")})}(o.element).filter(function(e){return!e.matches(o.settings.closeButtonSelector)})).length&&(e=t[0]),(e||o.contentElement).focus())})},a.close=function(e){var t=a.getInstance(e);if(!t)return!1;AnimateHelper.animateThenDo(e,t.settings.closeAnimationClass,function(){t.state=d,t.element.classList.remove(t.settings.isOpenClass),document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass+"-"+t.element.id),t.wasHidden&&t.element.setAttribute("hidden",""),t.element.wasHidden=void 0,a.hasAnyElementOpen()||document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass),t.previousActiveElement&&t.previousActiveElement.focus()})},a.closeAll=function(){for(var e=0;e<a.managers.length;e++){var t=a.managers[e];a.getState(t.element)!=d&&a.close(t.element)}},a.toggle=function(e){a.getState(e)==d?a.open(e):a.close(e)},a.getInstance=function(e){for(var t,o=0;o<a.managers.length;o++){var n=a.managers[o];if(n.element==e){t=n;break}}return t},a.hasAnyElementOpen=function(){for(var e=0;e<a.managers.length;e++)if(a.managers[e].state==c)return!0;return!1},a.initializeTrigger=function(e){e.removeAttribute("disabled"),e.removeAttribute("aria-hidden"),e.setAttribute("tabindex","0"),e.setAttribute("role","button");var t=e.getAttribute("href");null!=t&&""!=t&&(document.querySelector(t)&&e.setAttribute(i.targetElementAttribute,t),e.getAttribute(i.targetElementAttribute)&&e.removeAttribute("href"))},a.initializeElement=function(e){var t={};t.element=e,t.settings=v(i),t.state=d,t.element.id&&""!=t.element.id||(t.element.id=t.settings.idPrefix+"-"+a.managers.length),t.contentElement=t.element.querySelector(t.settings.flyoutContentSelector);var o=t.element.getAttribute(t.settings.openAnimationClassAttribute),e=t.element.getAttribute(t.settings.closeAnimationClassAttribute);t.settings.openAnimationClass=o&&""!=o?o:i.openAnimationClass,t.settings.closeAnimationClass=e&&""!=e?e:i.closeAnimationClass;e="alert"==t.element.getAttribute(t.settings.flyoutRoleAttribute)||"alertdialog"==t.element.getAttribute(t.settings.flyoutRoleAttribute)?"alertdialog":"dialog";t.contentElement.setAttribute("role",e),t.isActivated=!0,t.element.classList.add(t.settings.isActivatedClass),a.managers.push(t)};function S(e){(i=v(u,e)).triggerSelectors=i.toggleButtonSelector+", "+i.openButtonSelector+", "+i.closeButtonSelector;for(var t=document.querySelectorAll(i.flyoutWrapperSelector),o=0;o<t.length;o++)a.initializeElement(t[o]);for(var n=document.querySelectorAll(i.triggerSelectors),o=0;o<n.length;o++)a.initializeTrigger(n[o]);(e=document.createElement("div")).innerHTML=i.overlayTemplate.trim(),document.body.appendChild(e.childNodes[0]),document.addEventListener("click",l),document.addEventListener("keydown",r,!0),document.body.classList.add(i.bodyHasFlyoutClass),s=!0}return a.init=function(e){s||(window.AnimateHelper?S(e):window.RequireBundle&&RequireBundle.require(["animate-helper"],function(){S(e)}))},a});
//# sourceMappingURL=maps/flyout-block.min.js.map
