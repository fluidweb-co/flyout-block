{"version":3,"file":"../flyout-block.min.js","sources":["flyout-block.js"],"sourcesContent":["/**\n * Manage states and views for the flyout blocks.\n * \n * File flyout-block.js.\n */\n(function (root, factory) {\n\tif ( typeof define === 'function' && define.amd ) {\n\t\tdefine([], factory(root));\n\t} else if ( typeof exports === 'object' ) {\n\t\tmodule.exports = factory(root);\n\t} else {\n\t\troot.FlyoutBlock = factory(root);\n\t}\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\n\n\t'use strict';\n\n\tvar _hasInitialized = false;\n\tvar _publicMethods = {\n\t\tmanagers: [],\n\t};\n\tvar _settings = { };\n\tvar _defaults = {\n\t\tflyoutWrapperSelector: '[data-flyout]',\n\t\tflyoutContentSelector: '[data-flyout-content]',\n\t\ttoggleButtonSelector: '[data-flyout-toggle]',\n\t\topenButtonSelector: '[data-flyout-open]',\n\t\tcloseButtonSelector: '[data-flyout-close]',\n\t\toverlaySelector: '[data-flyout-overlay]',\n\t\tflyoutTogglePassActionSelector: '[data-flyout-pass-action], .js-flyout-pass-action',\n\n\t\tflyoutToggleClassSelector: '.js-flyout-toggle',\n\t\tflyoutClassTogglePrefix: 'js-flyout-target-',\n\t\t\n\t\tidPrefix: 'flyout-block',\n\t\t\n\t\tbodyHasFlyoutClass: 'has-flyout',\n\t\tbodyHasFlyoutOpenClass: 'has-flyout--open',\n\t\tisActivatedClass: 'is-activated',\n\t\tisOpenClass: 'is-open',\n\t\topenAnimationClass: 'slide-in-up',\n\t\tcloseAnimationClass: 'slide-out-down',\n\t\t\n\t\ttargetElementAttribute: 'data-flyout-target',\n\t\topenAnimationClassAttribute: 'data-flyout-open-animation-class',\n\t\tcloseAnimationClassAttribute: 'data-flyout-close-animation-class',\n\t\tmanualFocusAttribute: 'data-flyout-manual-focus',\n\t\tautoFocusAttribute: 'data-autofocus',\n\t\t\n\t\tflyoutRoleAttribute: 'data-flyout-role',\n\n\t\toverlayTemplate: '<div class=\"flyout-overlay\" data-flyout-overlay></div>',\n\t};\n\tvar _states = {\n\t\tOPEN: 'open',\n\t\tCLOSED: 'closed',\n\t}\n\n\n\n\t/*!\n\t* Merge two or more objects together.\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\n\t* @param   {Object}   objects  The objects to merge together\n\t* @returns {Object}            Merged values of defaults and options\n\t*/\n\tvar extend = function () {\n\t\t// Variables\n\t\tvar extended = {};\n\t\tvar deep = false;\n\t\tvar i = 0;\n\n\t\t// Check if a deep merge\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tvar merge = function (obj) {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\t// If property is an object, merge properties\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar obj = arguments[i];\n\t\t\tmerge(obj);\n\t\t}\n\n\t\treturn extended;\n\t};\n\n\n\t/**\n\t * Gets keyboard-focusable elements within a specified element\n\t *\n\t * @param   HTMLElement  element  The element to search within. Defaults to the `document` root element.\n\t *\n\t * @return  array                 All focusable elements withing the element passed.\n\t */\n\tvar getFocusableElements = function( element ) {\n\t\t// Set element to `document` root if not passed in\n\t\tif ( ! element ) { element = document; }\n\t\t\n\t\t// Get elements that are keyboard-focusable, but might be `disabled`\n\t\tvar maybeFocusableElements = element.querySelectorAll( 'a, button, input:not([type=\"hidden\"]), textarea, select, details,[tabindex]:not([tabindex=\"-1\"])' );\n\t\t\n\t\t// Filter disabled elements and return\n\t\treturn Array.from( maybeFocusableElements ).filter( function( maybeFocusable ) {\n\t\t\treturn ! maybeFocusable.hasAttribute( 'disabled' );\n\t\t} );\n\t}\n\n\n\n\t/**\n\t * Get target element\n\t */\n\tvar getTargetElement = function( element ) {\n\t\t// Bail if element not valid\n\t\tif ( ! element ) return false;\n\n\t\t// Try get target element from attributes\n\t\tvar targetSelector = element.getAttribute( _settings.targetElementAttribute );\n\t\tif ( targetSelector && targetSelector != '' ) {\n\t\t\treturn document.querySelector( targetSelector );\n\t\t}\n\n\t\t// Return target element from parent nodes\n\t\treturn element.closest( _settings.flyoutWrapperSelector );\n\t}\n\n\n\n\t/**\n\t * Get target element\n\t */\n\tvar getTargetElementFromClass = function( element ) {\n\t\tif ( ! element ) { return false; }\n\n\t\t// Iterate classes\n\t\tfor ( var i = 0; i < element.classList.length; i++ ) {\n\t\t\tvar cssClass = element.classList[i];\n\t\t\tif ( cssClass.indexOf( _settings.flyoutClassTogglePrefix ) == 0 ) {\n\t\t\t\t// Get target id from class name\n\t\t\t\tvar targetSelector = '#' + cssClass.replace( _settings.flyoutClassTogglePrefix, '' );\n\t\t\t\treturn document.querySelector( targetSelector );\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\n\n\t/**\n\t * Handle document clicks and route to the appropriate function.\n\t */\n\tvar handleClick = function ( e ) {\n\t\t// TOGGLE\n\t\tif ( e.target.closest( _settings.toggleButtonSelector ) ) {\n\t\t\te.preventDefault();\n\t\t\tvar button = e.target.closest( _settings.toggleButtonSelector );\n\t\t\tvar element = getTargetElement( button );\n\t\t\t_publicMethods.toggle( element );\n\t\t}\n\t\t// TOGGLE (CSS CLASS)\n\t\telse if ( e.target.closest( _settings.flyoutToggleClassSelector ) ) {\n\t\t\t// Maybe prevent element's action\n\t\t\tif ( ! e.target.closest( _settings.flyoutTogglePassActionSelector ) ) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\n\t\t\tvar toggleElement = e.target.closest( _settings.flyoutToggleClassSelector );\n\t\t\tvar element = getTargetElementFromClass( toggleElement );\n\t\t\t\n\t\t\tif ( element ) {\n\t\t\t\t_publicMethods.toggle( element );\n\t\t\t}\n\t\t}\n\t\t// OPEN\n\t\telse if ( e.target.closest( _settings.openButtonSelector ) ) {\n\t\t\te.preventDefault();\n\t\t\tvar button = e.target.closest( _settings.openButtonSelector );\n\t\t\tvar element = getTargetElement( button );\n\t\t\t_publicMethods.open( element );\n\t\t}\n\t\t// CLOSE\n\t\telse if ( e.target.closest( _settings.closeButtonSelector ) ) {\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tvar button = e.target.closest( _settings.closeButtonSelector );\n\t\t\tvar element = getTargetElement( button );\n\t\t\t_publicMethods.close( element );\n\t\t}\n\t\t// OVERLAY - Specific to a flyout block\n\t\telse if ( e.target.matches( _settings.flyoutWrapperSelector ) ) {\n\t\t\tvar element = getTargetElement( e.target );\n\t\t\t_publicMethods.close( element );\n\t\t}\n\t\t// OVERLAY - General\n\t\telse if ( e.target.closest( _settings.overlaySelector ) ) {\n\t\t\t_publicMethods.closeAll();\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Handle keypress event.\n\t */\n\tvar handleKeyDown = function(e) {\n\t\tif ( e.keyCode == 27 || e.which == 27 || e.key == 'Escape' || e.key == 'Esc' ) {\n\t\t\t_publicMethods.closeAll();\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Get current state of element\n\t */\n\t_publicMethods.getState = function ( element ) {\n\t\tvar manager = _publicMethods.getInstance( element );\n\t\t// Bail if manager invalid\n\t\tif ( ! manager ) return false;\n\n\t\treturn manager.state;\n\t}\n\n\n\n\t/**\n\t * Open element\n\t */\n\t_publicMethods.open = function ( element ) {\n\t\tvar manager = _publicMethods.getInstance( element );\n\t\t// Bail if manager invalid\n\t\tif ( ! manager ) return false;\n\n\t\t// Save element with focus\n\t\tmanager.previousActiveElement = document.activeElement;\n\n\t\t// Set element open then play openning animation\n\t\tAnimateHelper.doThenAnimate( element, manager.settings.openAnimationClass, function() {\n\t\t\t// Set manager state\n\t\t\tmanager.state = _states.OPEN;\n\n\t\t\t// Maybe save `hidden` attribute on the flyout element\n\t\t\tmanager.wasHidden = manager.element.hasAttribute( 'hidden' );\n\t\t\tmanager.element.removeAttribute( 'hidden' );\n\n\t\t\t// Set classes\n\t\t\tmanager.element.classList.add( manager.settings.isOpenClass );\n\t\t\tdocument.body.classList.add( manager.settings.bodyHasFlyoutOpenClass,manager.settings.bodyHasFlyoutOpenClass + '-' + manager.element.id );\n\n\t\t\t// Maybe set focus to the first focusable element in the flyout content, filter out the close button\n\t\t\tif ( ! manager.element.hasAttribute( manager.settings.manualFocusAttribute ) ) {\n\t\t\t\tvar autofocusField = manager.element.querySelector( '[' + manager.settings.autoFocusAttribute + ']' );\n\n\t\t\t\tconsole.log( autofocusField );\n\n\t\t\t\t// Maybe get first focusable field\n\t\t\t\tif ( ! autofocusField ) {\n\t\t\t\t\tvar focusableElements = getFocusableElements( manager.element ).filter( function( maybeFocusable ) { return ! maybeFocusable.matches( manager.settings.closeButtonSelector ); } );\n\t\t\t\t\tif ( focusableElements.length > 0 ) {\n\t\t\t\t\t\tautofocusField = focusableElements[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Maybe set focus to the field\n\t\t\t\tif ( autofocusField ) {\n\t\t\t\t\tautofocusField.focus();\n\t\t\t\t}\n\t\t\t\t// Otherwise set focus to the flyout content\n\t\t\t\telse {\n\t\t\t\t\tmanager.contentElement.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\n\t\n\t/**\n\t * Close element\n\t */\n\t_publicMethods.close = function ( element ) {   \n\t\tvar manager = _publicMethods.getInstance( element );\n\t\t// Bail if manager invalid\n\t\tif ( ! manager ) return false;\n\n\t\t// Play closing animation then set element closed\n\t\tAnimateHelper.animateThenDo( element, manager.settings.closeAnimationClass, function() {\n\t\t\t// Set manager state\n\t\t\tmanager.state = _states.CLOSED;\n\n\t\t\t// Remove classes\n\t\t\tmanager.element.classList.remove( manager.settings.isOpenClass );\n\t\t\tdocument.body.classList.remove( manager.settings.bodyHasFlyoutOpenClass + '-' + manager.element.id );\n\n\t\t\t// Maybe set `hidden` attribute again\n\t\t\tif ( manager.wasHidden ) {\n\t\t\t\tmanager.element.setAttribute( 'hidden', '' );\n\t\t\t}\n\t\t\tmanager.element.wasHidden = undefined;\n\n\t\t\t// Maybe remove body class for open elements\n\t\t\tif ( ! _publicMethods.hasAnyElementOpen() ) {\n\t\t\t\tdocument.body.classList.remove( manager.settings.bodyHasFlyoutOpenClass );\n\t\t\t}\n\n\t\t\t// Set focus back to the element previously with focus\n\t\t\tif ( manager.previousActiveElement ) {\n\t\t\t\tmanager.previousActiveElement.focus();\n\t\t\t}\n\t\t} );\n\t}\n\n\n\n\t/**\n\t * Close all instances\n\t */\n\t_publicMethods.closeAll = function () {\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tvar currentState = _publicMethods.getState( manager.element );\n\t\t\tif ( currentState != _states.CLOSED ) {\n\t\t\t\t_publicMethods.close( manager.element );\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Toggle element state\n\t */\n\t_publicMethods.toggle = function ( element ) {\n\t\tvar currentState = _publicMethods.getState( element );\n\t\tif ( currentState == _states.CLOSED ) {\n\t\t\t_publicMethods.open( element );\n\t\t}\n\t\telse {\n\t\t\t_publicMethods.close( element );\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Get manager instance for element\n\t */\n\t_publicMethods.getInstance = function ( element ) {\n\t\tvar instance;\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tif ( manager.element == element ) { instance = manager; break; }\n\t\t}\n\t\treturn instance;\n\t}\n\t\n\n\n\t/**\n\t * Get manager instance for element\n\t */\n\t_publicMethods.hasAnyElementOpen = function () {\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tif ( manager.state == _states.OPEN ) { return true; }\n\t\t}\n\t\t\n\t\treturn false;\n\t}\n\n\n\n\t/**\n\t * Initialize a trigger elements.\n\t */\n\t _publicMethods.initializeTrigger = function( trigger ) {\n\t\t// Enable the trigger element\n\t\ttrigger.removeAttribute( 'disabled' );\n\t\ttrigger.removeAttribute( 'aria-hidden' );\n\t\t\n\t\t// Add the element to the natural tab order\n\t\ttrigger.setAttribute( 'tabindex', '0' );\n\n\t\t// Set trigger role to `button`\n\t\ttrigger.setAttribute( 'role', 'button' );\n\n\t\t// Maybe remove the `href` attribute to avoid right-click to open link on new tab\n\t\tvar triggerHref = trigger.getAttribute( 'href' );\n\t\tif ( triggerHref != undefined && triggerHref != '' ) {\n\t\t\t\n\t\t\t// Move selector to the target attribute\n\t\t\tvar targetElement = document.querySelector( triggerHref )\n\t\t\tif ( targetElement ) {\n\t\t\t\ttrigger.setAttribute( _settings.targetElementAttribute, triggerHref );\n\t\t\t}\n\n\t\t\t// Only remove the `href` attribute if the element has a target\n\t\t\tif ( trigger.getAttribute( _settings.targetElementAttribute ) ) {\n\t\t\t\ttrigger.removeAttribute( 'href' );\n\t\t\t}\n\n\t\t}\n\t}\n\t\n\n\n\t/**\n\t * Initialize an element\n\t */\n\t_publicMethods.initializeElement = function( element ) {\n\t\tvar manager = {};\n\t\tmanager.element = element;\n\t\tmanager.settings = extend( _settings );\n\t\tmanager.state = _states.CLOSED;\n\n\t\t// Maybe create element ID\n\t\tif ( ! manager.element.id || manager.element.id == '' ) {\n\t\t\tmanager.element.id = manager.settings.idPrefix + '-' + _publicMethods.managers.length;\n\t\t}\n\n\t\t// Get the content element\n\t\tmanager.contentElement = manager.element.querySelector( manager.settings.flyoutContentSelector );\n\t\t\n\t\t// Try get open/close animation classes from attributes\n\t\tvar openAnimationAttrValue = manager.element.getAttribute( manager.settings.openAnimationClassAttribute );\n\t\tvar closeAnimationAttrValue = manager.element.getAttribute( manager.settings.closeAnimationClassAttribute );\n\t\tmanager.settings.openAnimationClass = openAnimationAttrValue && openAnimationAttrValue != '' ? openAnimationAttrValue : _settings.openAnimationClass;\n\t\tmanager.settings.closeAnimationClass = closeAnimationAttrValue && closeAnimationAttrValue != '' ? closeAnimationAttrValue : _settings.closeAnimationClass;\n\n\t\t// Set flyout content `role` attribute from data attributes\n\t\tvar roleAttrValue = manager.element.getAttribute( manager.settings.flyoutRoleAttribute ) == 'alert' || manager.element.getAttribute( manager.settings.flyoutRoleAttribute ) == 'alertdialog' ? 'alertdialog' : 'dialog';\n\t\tmanager.contentElement.setAttribute( 'role', roleAttrValue );\n\t\t\n\t\t// Set element as activated\n\t\tmanager.isActivated = true;\n\t\tmanager.element.classList.add( manager.settings.isActivatedClass );\n\t\t\n\t\t// Add manager to public methods\n\t\t_publicMethods.managers.push( manager );\n\t}\n\n\n\n\t/**\n\t * Finish Initialize\n\t */\n\t var finishInit = function( options ) {\n\t\t// Merge with general settings with options\n\t\t_settings = extend( _defaults, options );\n\n\t\t// Iterate elements\n\t\tvar elements = document.querySelectorAll( _settings.flyoutWrapperSelector );\n\t\tfor ( var i = 0; i < elements.length; i++ ) {\n\t\t\t_publicMethods.initializeElement( elements[ i ] );\n\t\t}\n\n\t\t// Iterate trigger elements\n\t\tvar triggerSelectors = _settings.toggleButtonSelector + ', ' + _settings.openButtonSelector + ', ' + _settings.closeButtonSelector;\n\t\tvar triggers = document.querySelectorAll( triggerSelectors );\n\t\tfor ( var i = 0; i < triggers.length; i++ ) {\n\t\t\t_publicMethods.initializeTrigger( triggers[ i ] );\n\t\t}\n\n\t\t// Add flyout overlay\n\t\tvar overlayElement = document.createElement('div');\n\t\toverlayElement.innerHTML = _settings.overlayTemplate.trim();\n\t\tdocument.body.appendChild( overlayElement.childNodes[0] );\n\n\t\t// Add event listeners\n\t\tdocument.addEventListener( 'click', handleClick );\n\t\tdocument.addEventListener( 'keydown', handleKeyDown, true );\n\t\t\n\t\t// Add body class\n\t\tdocument.body.classList.add( _settings.bodyHasFlyoutClass );\n\n\t\t_hasInitialized = true;\n\t}\n\n\t\n\n\t/**\n\t * Initialize Script.\n\t */\n\t_publicMethods.init = function( options ) {\n\t\tif ( _hasInitialized ) return;\n\n\t\t// Finish initialization, maybe load dependencies first\n\t\tif ( window.AnimateHelper ) {\n\t\t\tfinishInit( options );\n\t\t}\n\t\telse if( window.RequireBundle ) {\n\t\t\tRequireBundle.require( [ 'animate-helper' ], function() { finishInit( options ); } );\n\t\t}\n\t};\n\n\n\n\t//\n\t// Public APIs\n\t//\n\treturn _publicMethods;\n\n});\n"],"names":["root","factory","define","amd","exports","module","FlyoutBlock","global","this","window","getTargetElement","element","targetSelector","getAttribute","_settings","targetElementAttribute","document","querySelector","closest","flyoutWrapperSelector","handleClick","e","button","target","toggleButtonSelector","preventDefault","_publicMethods","toggle","flyoutToggleClassSelector","flyoutTogglePassActionSelector","i","classList","length","cssClass","indexOf","flyoutClassTogglePrefix","replace","getTargetElementFromClass","openButtonSelector","open","closeButtonSelector","close","matches","overlaySelector","closeAll","handleKeyDown","keyCode","which","key","_hasInitialized","managers","_defaults","flyoutContentSelector","idPrefix","bodyHasFlyoutClass","bodyHasFlyoutOpenClass","isActivatedClass","isOpenClass","openAnimationClass","closeAnimationClass","openAnimationClassAttribute","closeAnimationClassAttribute","manualFocusAttribute","autoFocusAttribute","flyoutRoleAttribute","overlayTemplate","_states","extend","extended","deep","Object","prototype","toString","call","arguments","obj","prop","hasOwnProperty","merge","getState","manager","getInstance","state","previousActiveElement","activeElement","AnimateHelper","doThenAnimate","settings","autofocusField","focusableElements","wasHidden","hasAttribute","removeAttribute","add","body","id","console","log","maybeFocusableElements","querySelectorAll","Array","from","filter","maybeFocusable","getFocusableElements","contentElement","focus","animateThenDo","remove","setAttribute","undefined","hasAnyElementOpen","instance","initializeTrigger","trigger","triggerHref","initializeElement","openAnimationAttrValue","closeAnimationAttrValue","roleAttrValue","isActivated","push","finishInit","options","elements","triggerSelectors","triggers","overlayElement","createElement","innerHTML","trim","appendChild","childNodes","addEventListener","init","RequireBundle","require"],"mappings":"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"}